---
title: Examining spatial equity and accessibility to a public bicycle share program using a balanced floating catchment area approach 
author:
  - name: Elise Desjardins
    email: desjae@mcmaster.ca
    affiliation: Some School
    footnote: 1
  - name: Christopher D. Higgins
    email: cd.higgins@utoronto.ca
    affiliation: Another University
    footnote: 2
  - name: Antonio Paez
    email: paezha@mcmaster.ca
    affiliation: Some School
    footnote: 2
address:
  - code: McMaster University
    address: School of Earth, Environment & Society, 1280 Main Street West, Hamilton, ON L8S4L8
  - code: University of Toronto Scarborough
    address: Department of Geography & Planning, 1265 Military Trail, Toronto, ON M1C1A4
footnote:
  - code: 1
    text: "Corresponding Author"
  - code: 2
    text: "Equal contribution"
abstract: 
  
  Public bicycle share programs are implemented to promote cycling as a convenient and sustainable mode of transportation. These systems can also play a role in addressing transportation needs and advancing transportation equity if they make cycling more accessible to lower income or disadvantaged populations. Recent studies assessing equity in bike sharing have found differences in ridership or membership based on income, education, and trip purpose. In Ontario, the City of Hamilton launched a public bicycle share program in 2015 that currently has over 900 operational bicycles and 130 docking stations. In 2018, the non-profit organization that operates the program launched an equity initiative to provide subsidized memberships and to expand service by adding twelve docking stations. Previous research found that Hamiltonâ€™s public bicycle share program targeted well disadvantaged areas in the city compared to programs in other Canadian cities.  Since the time or distance that members of the population need to reach a bicycle share station decreases the potential of accessing the program, the location of stations matters. Unlike other public amenities with greater ability to adapt to crowding, the utility of stations is limited by the number of bicycles that they can hold, which makes crowding effects critical; the system may not necessarily be improved if stations are easy to reach but offer only a small number of bicycles. In this research, we revisit the case of Hamilton and investigate equity differentials in accessibility to bicycle share stations. We compare accessibility in the program with and without the equity stations to assess the effect of the initiative. Previous research on cycling equity or accessibility has used a macro-level approach with entire neighbourhoods or census tracts as the unit of analysis, although there are recent exceptions. In contrast, we implement our analysis parting from microscopic zones to better reflect travel to a docking station, which often happens at the sub-neighborhood level, and conduct a sensitivity analysis at several walking thresholds. We then reaggregate the estimated accessibility to dissemination areas for further analysis using census data. Equity analysis of this type is possible thanks to a newly developed approach for accessibility using balanced floating catchment areas. The addition of equity stations achieved its goal to increase accessibility for lower income populations, although the increase was relatively modest (2.10 bicycles/person with equity stations vs 1.97 bicycles/person without equity stations). Further research is needed to determine whether this encouraged more cycling.

journal: "Transportation Research Part D: Transport and Environment"
date: "`r Sys.Date()`"
bibliography: references.bib
#linenumbers: true
#numbersections: true
csl: elsevier-harvard.csl
output: rticles::elsevier_article
---

```{r, include=FALSE}
rm(list = ls())
```

```{r load-packages, include=FALSE}
library(biscale)
library(cowplot)
library(data.table)
library(dplyr)
library(gdistance)
library(gridExtra)
library(kableExtra)
library(patchwork)
library(readr)
library(raster)
library(rgdal)
library(sf)
library(sobiEquity)
library(tidyverse)
library(tinytex)
library(units)
#library(disk.frame)
#library(pycno)
#library(r5r) # the r5r package requires Java Development Kit version 11, which can be downloaded from https://www.oracle.com/java/technologies/javase-jdk11-downloads.html
```

```{r invoke-data, include=FALSE}
data("community_downtown")
data("hamilton_cma")
data("hamilton_da_2016")
data("population_50x50")
data("sobi_service")
data("sobi_hubs")
data("ttm_walk")
```

```{r crop-das, include=FALSE}
# Crop DAs using bounding box of service area
sobi_service_bbox <- sobi_service %>% 
  st_bbox() %>%
  st_as_sfc()

cropped_da <- hamilton_da_2016 %>%
  st_crop(sobi_service_bbox) %>%
  dplyr::select(DA, geometry)
```

Introduction
===================

The potential of public bicycle share programs (PBSPs) to increase cycling levels [see @hosfordEvaluationImpactPublic2018; @hosfordEvaluatingImpactImplementing2019] is one of many reasons for implementing such programs in urban areas. As a healthy, inexpensive, and convenient form of public transportation, shared bicycles can encourage individuals to take up cycling for short local trips or first and last mile trips to other public transportation instead of using personal vehicles. Although these programs are available to the general public and ought to be accessible for all individuals who wish to use them, research from PBSPs located in North American and European cities indicates that there are inequities in usage and access that need to be addressed.

## Literature Review

Public bicycle share programs (PBSP) have been implemented in over 800 cities worldwide and a great deal has been learned about their typical users [@fishmanBikeshareReviewRecent2016]. In many cities, males use bike share more than females [@breyWantRideMy2017; @nickkarSpatialtemporalGenderLand2019; @ogilvieInequalitiesUsagePublic2012; @reillyGenderDisparitiesNew2020; @wintersWhoAreSuperusers2019] as do younger age cohorts [@breyWantRideMy2017; @buckAreBikeshareUsers2013; @fullerUseNewPublic2011]. However, one study found that bike share users in Washington, DC were more likely to be female [@buckAreBikeshareUsers2013], which suggests that the gender gap among cyclists who use bike share is less disparate than the gap for personal bicycle use [@fishmanBikeshareReviewRecent2016]. There is some evidence that bike share users are less likely to own a car [@buckAreBikeshareUsers2013; @reillyNoncyclistsFrequentCyclists2020]. However, the relationship between income or education and bike share use is more nuanced. Stations in disadvantaged communities in Chicago were found to generate most of the average annual trips [@qianBikesharingEquityDisadvantaged2020] and individuals from minority or lower socioeconomic status neighbourhoods in Minneapolis-St. Paul used the city's PBSP more [@wangNeighborhoodSociodemographicCharacteristics2019]. Similar findings were reported in London [@ogilvieInequalitiesUsagePublic2012]. Being university educated was a significant correlate of bike share use in Montreal, Canada [@fullerUseNewPublic2011]. Finally, financial savings have been found to motivate those on a low income to use bike share [@fishmanBikeshareReviewRecent2016]. 

Many studies have found that geographic proximity to a bicycle share station, either living or working near one, is an important determinant of use or having a membership [@fishmanBikeshareReviewRecent2016; @fullerUseNewPublic2011]. This makes sense given that individuals are more likely to use services or programs that they can easily access. Several studies have recently explored the equity of PBSP by primarily examining who has access to bike share (e.g., differences by demographics or socioeconomic status) and where stations are located. It is important to note that equity can be achieved in two different ways: equal spatial distribution across a region (e.g., horizontal equity) or greater access for vulnerable or disadvantaged populations (e.g., vertical equity) [@chenExploringEquityPerformance2019]. Both are of interest to researchers and transport planners since they are often linked in that advantage, or conversely disadvantage, has spatial patterns. Using a negative binomial regression model, Qian and Jaller [-@qianBikesharingEquityDisadvantaged2020] estimated ridership in Chicago's PBSP among disadvantaged communities and found some disparities. While annual members in disadvantaged communities have a significantly lower share of trips compared to other areas in the city, they make longer trips. This suggests that they may be using PBSP for work commuting, which points to the importance of ensuring equitable access [@qianBikesharingEquityDisadvantaged2020]. Similar results were found in Philadelphia, where lower income areas generated fewer trips and it was suggested that efforts to increase equity within the program have not been as successful as intended [@caspiBikesharingPhiladelphiaLowerincome2019]. In the case of Seattle, all neighbourhoods had some level of access to dockless bikes but those with higher incomes and more residents of higher education had more bikes [@mooneyFreedomStationSpatial2019]. Babagoli et al. [-@babagoliExploringHealthSpatial2019] also found that neighbourhoods in New York City with higher affluence had the greatest proportion of Citi Bike stations. Researchers have recommended targeted expansion of stations to areas that use bike share but have inequitable access [@ogilvieInequalitiesUsagePublic2012].

On the whole, existing studies highlight the need for bicycle share systems to be more highly accessible for diverse populations in order to increase use beyond the "typical" users. This has been the focus of recent research [among others, see @auchinclossDesignBaselineDescription2020; @hullgrassoBikeShareEquity2020; @macarthurAdaptiveBikeShare2020]. Offering more people the option of using sustainable and active transportation, particularly those who have lower socioeconomic status and might benefit the most, is a worthy policy goal for cities with PBSPs. Several cities in North America have launched specific programs to address barriers to bike share or to expand service to more deprived areas: London, United Kingdom [@ogilvieInequalitiesUsagePublic2012]; Philadelphia, Pennsylvania [@caspiBikesharingPhiladelphiaLowerincome2019], and Hamilton, Ontario [@hosfordWhoArePublic2018]. Findings to date suggest that horizontal equity can be easier to achieve than vertical equity. However, exploring transportation equity by investigating where bicycle share stations are located, often using neighbourhoods or census tracts as the geographical unit of analysis, can ignore or miss the benefits that may be derived from adjacent zones. Meaning that, stations may be lacking in certain neighbourhoods but there may be stations accessible within a reasonable walking cutoff time. This is where accessibility becomes an important consideration.

Accessibility has been applied in both a positive and normative way to inform transportation planning [@paezMeasuringAccessibilityPositive2012], but its utility to this field has evolved over the past century and has increasingly become linked with recent interest in prioritizing local proximity and modes that are suitable for local trips like walking and cycling [@levineCenturyEvolutionAccessibility2020]. As a measure of the ease of reaching potential destinations spread spatially in a given area, accessibility is relevant to PBSPs because it can identify current inequities in usage, as well as guide interventions that increase access for groups that are under-serviced or address gaps in transportation options. It also addresses some of the challenges of other performance measures such as level of service within a transportation network by measuring person-based indicators and exploring differences in use between population groups [@paezMeasuringAccessibilityPositive2012].

Beyond the utility derived from using shared bikes to destinations of value, an important aspect of accessibility associated with PBSPs is the distance an individual must travel to reach a bicycle share station [@kabraBikeShareSystemsAccessibility2020; @wangNewBikeShare2019]. Since the time or distance that members of the population need to reach a bicycle share station decreases the potential of accessing the program and ultimately their use of the program, the location and size (e.g., maximum number of bicycle racks available) of stations matters. Indeed, distance to bicycle share stations is associated with use [@fullerUseNewPublic2011; @wangNewBikeShare2019] and can be a barrier to using PBSPs [@fishmanBarriersBikesharingAnalysis2014]. Kabra et al. [-@kabraBikeShareSystemsAccessibility2020] found that the majority of bike share usage in Paris comes from areas within 300m of stations. Furthermore, unlike other public amenities with greater ability to adapt to crowding, like health care services, the utility of stations is limited by the number of bicycles that they can hold, which makes crowding effects critical. The program may not necessarily be improved if stations are easy to reach but offer only a small number of bicycles. Likewise, more people may not opt to use the program if the supply of bicycles available at the nearest station is insufficient to meet demand. The location and size of stations is important to increase the utility of this public transportation option for more people, thus achieving vertical equity. Accessibility analyses for PBSPs constitute a positive and evaluation-based approach that also has the potential to inform equity efforts. For instance, Wang and Lindsey [-@wangNewBikeShare2019] investigated whether new or relocated bicycle share stations increased accessibility and use, which offered important insights to improve the performance of the program.

Several approaches have been commonly used for measuring place-based accessibility, including cumulative opportunities, gravity, and utility-based measures [@handyMeasuringAccessibilityExploration1997]. Geurs and Van Wee [-@geursAccessibilityEvaluationLanduse2004] and Paez et al. [-@paezMeasuringAccessibilityPositive2012] provide recent overviews of various formulations and applications of accessibility in transportation research. The common gravity-based approach for example involves weighting destination opportunities, such as the quantity of bicycle share stations, by the time required to reach them from an origin using an impedance function [@handyMeasuringAccessibilityExploration1997; @kwanSpaceTimeIntegral1998]. However, while such measures are suitable for capturing the potential for reaching destinations from a given location, they do not take demand or congestion effects into account.

In contrast, floating catchment area (FCA) methods incorporate information on capacity and demand in calculating accessibility. FCA measures have been widely employed in healthcare accessibility research and are typically calculated across two steps. In the first, a ratio of supply to demand at service locations is calculated, such as the number of beds at a hospital divided by the number of people within the catchment area of the hospital, weighted by the distance involved in reaching the facility. Next, these service level ratios are allocated back to the population centres and summarized as a measure of congested accessibility. Thus, this model does a good job of considering potential crowding or competition for services. While there have been many methodological innovations in FCA methods [for example, @delamaterSpatialAccessibilitySuboptimally2013; @luoMeasuresSpatialAccessibility2003; @luoEnhancedTwostepFloating2009; @radkeSpatialDecompositionsModeling2000; @wanThreestepFloatingCatchment2012], a recent improvement to this approach was achieved through a simple and intuitive balanced FCA approach that addressed the effects of demand and service inflation from previous FCA approaches [see @paezDemandLevelService2019].

When measuring accessibility, researchers have taken different approaches when it comes to aggregation of data, either by using the individual or household as the smallest unit of analysis or larger spatial zones. Previous research on bike share equity has typically used a macro-level approach with aggregate data from entire neighbourhoods or census tracts  [@babagoliExploringHealthSpatial2019; @mooneyFreedomStationSpatial2019; @qianBikesharingEquityDisadvantaged2020; @wangNeighborhoodSociodemographicCharacteristics2019], although there are recent exceptions [@chenExploringEquityPerformance2019; @chenUnobservedHeterogeneityTransportation2021]. This is also true for studies examining correlates of bike share demand [@wangNewBikeShare2019]. Handy and Niemeier [-@handyMeasuringAccessibilityExploration1997] note that using disaggregated data in accessibility analyses provides a more accurate estimate for individuals, which is useful for addressing vertical inequities in PBSP usage.

Using the balanced floating catchment area method [@paezDemandLevelService2019], a novel approach that has not been used yet in cycling research, with disaggregate population-level data, we examine accessibility to a public bicycle share program in Hamilton, Ontario. We (1) conduct a sensitivity analysis by measuring accessibility and level of service to bike share stations at different thresholds of walking to reach a station: 3 minutes, 5 minutes, 10 minutes, and 15 minutes; (2) explore the contribution of specific stations that were added to Hamilton's PBSP to reducing both horizontal and vertical inequities; and (3) examine whether disparities in accessibility exist according to median household income of dissemination areas within the core service area.

Case Study {#sec:study}
======================

## Original System

This paper uses the city of Hamilton, located in Ontario, Canada, as a case study. The city launched a public bicycle share program, Hamilton Bike Share, in March 2015 with 115 stations and 750 bicycles [@hamiltonHamiltonBikeShare2015]. Before June 2020, the program was known as Social Bicycles or SoBi Hamilton but is now called Hamilton Bike Share. Stations are spaced between 300 and 600 metres apart [@scottRouteChoiceBike2021]. The core service area spans 40 square kilometres of the city although it was planned to be 20 square kilometres [@hamiltonsobi2015], and roughly 138,000 can reach a bike share hub within 30 minutes of walking [see Figure \ref{fig:hamilton-and-sobi-service-area}]. This represents roughly one fifth of the population in Hamilton according to the 2016 Canadian Census. The City of Hamilton undertook a large public engagement campaign to validate the locations of bicycle share stations that had been selected and to crowdsource potential locations for additional locations [@hamiltonsobi2014]. Most of the suggested locations were in the east end of the core service area that lack stations or in neighbourhoods not serviced by the PBSP. Inadequate coverage given the size of the Hamilton Bike Share's service area was identified as a problem early on, with transportation planners noting that the small size (i.e., supply of bicycle racks) and low quantity of stations would lead to challenges in balancing the system [@hamiltonsobi2015]. Based on public feedback, 13 stations were added to the original system. The program was enthusiastically welcomed in the city in 2015 - within three weeks of launching, 10,000 trips had been made [@hamiltonHamiltonBikeShare2015]. 

## Equity Initiative

In 2017, Hamilton Bike Share Inc., the non-profit organization that operates the program, initiated an equity program, Everyone Rides Initiative (ERI), to remove barriers that may prevent individuals from accessing bike share in Hamilton. Additional bicycles and stations were added to the program which expanded it to more disadvantaged areas in the core service area [see Figure 2]. The program also offers subsidized memberships to individuals who identify as low income as well as cycle skills education. A comparable program can be found in Philadelphia [see @caspiBikesharingPhiladelphiaLowerincome2019].

## Current System

As of June 2020, Hamilton Bike Share has 900 bikes, 130 stations [see Figure \ref{fig:sobi-stations-in-hamilton}], and over 26,000 active memberships [@hamiltonHamiltonBikeShare2015]. The core service area remains 40 square kilometres. The PBSP has 13 stations that were added as part of the ERI initiative; we refer to these as "equity stations" throughout the paper while all other stations are "conventional stations". In total, 117 stations are "conventional" and 13 are "equity".

## Membership

Hamilton Bike Share conducted one membership survey in 2018 [@civicplanSoBiHamiltonMembership2017] and the findings from 420 members are broadly in line with the trends that were discussed above [see @fishmanBikeshareReviewRecent2016 for a recent review of the literature]. The majority of respondents live within the core service area and the gender split is expected: 57% of respondents are male and 41% are female. The majority of respondents, both male and female, are between 25 and 34 years of age, but the percentage of male respondents is higher in the subsequent age groups. Respondents use bike share for commuting (40% of trips) or errands and meetings (24% of trips) and nearly 50% of trips have an average length of 11 to 20 minutes. As a result of having a bike share membership, 49% of respondents report that they use their private vehicle less often or much less often but 48% report that their private vehicle use has remained about the same. This suggests that SoBi Hamilton has been useful for certain kinds of trips but not all, meaning that some trips continue to require a private vehicle.

## Relevant Research

Our analysis builds upon a previous and recent study [@hosfordWhoArePublic2018], which found that areas in Hamilton with less advantage are better served by the city's PBSP compared to other Canadian cities [i.e., Toronto, Vancouver, Montreal, and Ottawa-Gatineau] where areas that are less deprived have greater access. Hosford and Winters [-@hosfordWhoArePublic2018] acknowledge that "Hamilton stands out in that the lower income neighborhoods are located near the city center and wealthier neighborhoods are in the surrounding suburban areas". Therefore, the core service area for the PBSP in Hamilton is by default in more disadvantaged areas compared to other parts of the city. However, there is also a great deal of variation in income in the city center because of the local university and increasing gentrification. Hosford and Winters [-@hosfordWhoArePublic2018] took a macro-level and system-wide approach in their analysis by using dissemination areas _across_ the city as the unit of analysis. They did not focus specifically on the core service area and did not differentiate between conventional and equity stations, which is worth exploring further. Therefore, this paper continues their analysis and makes an important contribution to the growing body of literature that examines equity issues in PBSPs.

```{r hamilton-and-sobi-service-area, echo=FALSE, fig.align = 'center', out.width = "65%", fig.cap = "The core service area of Hamilton Bike Share is outlined in black. Hamilton Census Metropolitan Area (CMA) is shown in grey."}
ggplot() + 
  geom_sf(data = hamilton_da_2016,
          color = NA,
          fill = "gray") + 
  geom_sf(data = sobi_service,
          fill = NA,
          colour = "black") + 
  theme(panel.background = element_rect(fill = "white"))
```

```{r sobi-stations-in-hamilton, echo=FALSE, fig.align = 'center', out.width = "100%", fig.cap = "The spatial distribution of bike share stations in Hamilton, Ontario. The service area of Hamilton Bike Share is outlined in black and the city's downtown core is outlined in dark green. Hamilton CMA is shown in grey."}
ggplot() + 
  geom_sf(data = cropped_da,
          color = NA,
          fill = "gray") +
  geom_sf(data = sobi_service, 
          fill = NA,
          color = "black") +
  geom_sf(data = community_downtown %>%
            dplyr::filter(NAME == "Hamilton"),
          fill = NA,
          size = 1,
          color = "dark green") +
  geom_sf(data = sobi_hubs %>% 
            dplyr::filter(hub_type == "Conventional" & 
                            hub_status == "Active"), # Remove deactivated hubs
          aes(size = RACKS_AMOU),
          shape = 21,
          fill = "blue") +
  geom_sf(data =  sobi_hubs %>% 
            dplyr::filter(hub_type == "ERI"), 
          aes(size = RACKS_AMOU), 
          shape = 21,
          fill = "green") +
  scale_size(name = "Number of racks", range = c(0.5, 4)) +
  theme(panel.background = element_rect(fill = "white"))
```

Methods {#sec:methods}
======================

## Floating Catchment Area

Floating catchment area (FCA) methods are an approach commonly used in the healthcare accessibility literature. This approach is more appropriate and informative than calculating the provider-to-population ratio (PPR) which simply divides the level of supply of a service (e.g., the number of bicycle racks at a station) by the population who have access to the service [@paezDemandLevelService2019]. In particular, the Two-Step Floating Catchment Area (2SFCA) method [@luoMeasuresSpatialAccessibility2003; @radkeSpatialDecompositionsModeling2000] produces flexible catchment areas for populations accessing a service rather than using rigid boundaries like PPR, which provides more useful information because it doesn't assume that people stay within the pre-defined boundaries [@paezDemandLevelService2019]. This is an important property that supports our rationale for applying this method to measure accessibility to Hamilton Bike Share. The City of Hamilton has positioned stations between 300 and 600 metres apart, but anticipates that hubs will service those living within a 250 metre buffer from the station [@hamiltonsobi2015]. The latter constitutes a normative statement: people ought to be able to access a station in less than 600 metres if they live in the core service area, with usage coming from 250 metres around. However, it is not known how far people are actually willing to travel to reach a station. It would be reasonable to assume that people are willing to walk beyond this threshold to access other stations if the ones nearest them have no supply of bicycles.

More recently, the _balanced_ floating catchment area (FCA) approach was developed to address issues with demand and supply inflation that result from the overlapping catchment areas produced by past FCA methods [@paezDemandLevelService2019]. Briefly, the overlapping of catchment areas leads to inflation of population totals and deflation of service levels across a study area and generates inaccurate or misleading accessibility estimates. In contrast, Paez et al. [-@paezDemandLevelService2019] adjust the impedance weights so that both supply and demand are proportionally allocated which eliminates the over-counting of population that leads to distortions in demand and supply. Other benefits of this adjusted method include consideration of competition which can occur when catchment areas overlap, as well as the preservation of system-wide population and level of service. Balanced floating catchment area methods have been used to explore accessibility to health care providers [@paezDemandLevelService2019] and COVID-19 health care services [@pereiraGeographicAccessCOVID192021], but have not yet been used in the cycling literature to explore issues of accessibility.

The first step in the balanced floating catchment area method is to allocate the population to be serviced by each Hamilton Bike Share station:
$$
P_j = {\sum_{i = 1}^{n} P_i{w_{ij}}}
$$

Next, the level of service at each station (i.e., the maximum number of bicycle racks) is divided by its estimated service population within the established catchment area:
$$
L_j = \frac {S_j}{P_j} = \frac {S_j}{{\sum_{i = 1}^{n} P_i{w_{ij}}}}
$$

Finally, the accessibility of population cell $i$ is calculated as the weighted sum of the level of service of all stations that can be reached from there according to normalized weights:
$$
A_i = {\sum_{j = 1}^{J} L_j{w_{ji}}} = {\sum_{j = 1}^{J} \frac {S_j{w_{ji}}}{\sum_{i = 1}^{n} P_i{w_{ij}}}}
$$

The approach uses instead a set of suitably normalized weights as follows:
$$
{w_{ij}^{i} = \frac {w_{ij}}{\sum_{j = 1}^{J} {w_{ji}}}}
$$

and
$$
{w_{ij}^{j} = \frac {w_{ij}}{\sum_{j = 1}^{J} {w_{ji}}}}
$$

These weights satisfy the following properties:
$$
\sum_{j = 1}^{J} {w^i_{ji}} = 1
$$

and
$$
\sum_{i = 1}^{n} {w^j_{ji}} = 1
$$

Finally, accessibility is calculated without risk of demand or supply inflation:
$$
A_i = {\sum_{j = 1}^{J} \frac {S_j{w^j_{ij}}}{\sum_{i = 1}^{n} P_i{w^i_{ij}}}}
$$

For this paper, we employ a hybrid location-based and person-based approach to calculating accessibility using disaggregate population data. In their review of accessibility measures, Geurs and van Wee [-@geursAccessibilityEvaluationLanduse2004] highlight the need for greater inclusion of individual spatio-temporal constraints but acknowledge the challenges of acquiring and analyzing person-based data. This comes after Kwan's [-@kwanSpaceTimeIntegral1998] work to show that space-time measures are more capable of capturing interpersonal differences, especially the effect of space-time constraints on individual behaviour, and are more helpful for unraveling gender/ethnic differences. Applying the balanced floating catchment area approach to allows us to examine accessibility by stratifying according to median household income, which would constitute the individual component of the accessibility measure [@geursAccessibilityEvaluationLanduse2004]. However, conducting a further sensitivity analysis to measure accessibility at different distance thresholds would help to consider potential spatio-temporal constraints. Different people may be willing to travel different distances to access a public bicycle share station.

## Pycnophylactic Interpolation

Following the method first presented by Tobler [-@toblerSmoothPycnophylacticInterpolation1979], we used pycnophylactic interpolation to disaggregate population from each dissemination area to smaller polygons that are 50 by 50 metres. This method involves smoothing out the population from each dissemination area while preserving total volume [see Figure \ref{fig:da-population}]. Since pycnophylactic interpolation occurs at such a micro scale, we had to ensure that population numbers were not reallocated or smoothed out to areas where people do not live in Hamilton (i.e., where schools or parks are located). To do so, we retrieved shapefiles for various geographic features [see Table \ref{tab:data-features}] from Open Hamilton. Next, we removed these features from the PBSP core service area and used pycnophylactic interpolation to disaggregate and reallocate population within the remaining area [see Figure \ref{fig:interpolated-population}].

```{r data-features, echo=FALSE}
data_tbl <- data.frame(
  Feature = c("Hamilton Bike Share Stations", "Golf Courses", "Parks", "Designated Large Employment Areas", "Municipal Parking Lots", "Cemeteries", "Environmentally Sensitive Areas", "Streets", "Educational Institutions", "Places of Worship", "Municipal Service Centres", "Recreation and Community Centres", "Arenas", "Emergency Stations", "Fire Stations", "Police Stations", "Railways", "Hospitals"),
  Description = c(
    "The location of stations and the number of racks available at each station.",
    "The location of City and privately owned golf courses.", 
    "The location of parks and other green spaces.",
    "The location of large business parks and industrial lands.",
    "The location of municipal car parks.",
    "The location of cemeteries.",
    "The location of either land or water areas containing natural features or significant ecological functions.",
    "The street network in Hamilton, including road classification for highways.",
    "The location of all educational institutions and schools.",
    "The location of buildings used for religious congregations.",
    "The location of all municipal service centres, including City Hall.",
    "The location of all recreation and community centres.",
    "The location of all indoor arenas.",
    "The location of all Emergency Management Services (EMS) Ambulance stations.",
    "The location of all fire stations.",
    "The location of all police stations.",
    "The railway network in Hamilton.",
    "The location of all hospitals."
  )
)

kable(data_tbl,
      "latex",
      booktabs = TRUE,
      caption = "\\label{tab:landscape-features}Landscape features extracted from the Hamilton Bike Share core service area before population is interpolated.") %>%
  kable_paper(full_width = F) %>%
  column_spec(1, bold = T, border_right = T) %>%
  column_spec(2, width = "30em") %>%
  kable_styling(latex_options = c("striped", "scale_down"))
```

```{r da-population, echo=FALSE, fig.align = 'center', out.width = "65%", fig.cap = "Population in all dissemination areas (outlined in white) in the Hamilton Bike Share core service area (outlined in black) and within 30 minutes of walking to the service area."}
ggplot() +
  geom_sf(data = hamilton_da_2016 %>%
            dplyr::filter(sobi_service == "Yes"),
          aes(fill = population),
          color = "white") +
  geom_sf(data = sobi_service,
          fill = NA) +
  scale_fill_distiller(palette = "YlOrRd", 
                       direction = 1) +
  theme(panel.background = element_rect(fill = "white"))
```

```{r interpolated-population, echo=FALSE, fig.align = 'center', out.width = "65%", fig.cap = "Interpolated population in the Hamilton Bike Share core service area (outlined in black) and within 30 minutes of walking to the core service area (outlined in blue). The downtown area is outlined in dark green. Geographic features have been extracted. Dissemination area polygons are outlined in grey."}
ggplot() + 
  geom_sf(data = cropped_da,
          fill = "gray",
          color = NA) + 
  geom_sf(data = population_50x50,
          aes(color = population)) +
  scale_color_distiller(palette = "YlOrRd", 
                        direction = 1) +
  geom_sf(data = sobi_service,
          fill = NA,
          colour = "black") +
  geom_sf(data = community_downtown %>%
            dplyr::filter(NAME == "Hamilton"),
          fill = NA,
          color = "dark green") +
  theme(panel.background = element_rect(fill = "white"))
```

## Travel Time Matrix

[BBBike](https://download.bbbike.org/osm/bbbike/) is an online cycle route planner that interfaces with OpenStreetMap. We extracted OpenStreetMap data for SoBi Hamilton's service area to calculate walking times from each population cell to nearby bike share stations, using a walking distance of 10km and a walking time of 30 minutes as a threshold. A travel time matrix was created with the origins as the coordinates of the population cells and the destinations as the coordinates of the bike share stations within the maximum threshold. This provides a more realistic measure of the temporal component by taking infrastructure into account of travel times, rather than using the Euclidean distance from population cell to station.

## Data

All data for this research were accessed from Open Hamilton^[https://open.hamilton.ca/], an online and public repository of data curated by the City of Hamilton.

Results
===================

## Accessibility by Distance Thresholds

Consensus regarding the distance that individuals are willing to walk to access a PBSP is lacking, but the literature on walking behaviour was consulted to determine the thresholds for the sensitivity analysis. Previous studies have found that living within 250 metres [@fullerUseNewPublic2011] and 300 metres [@kabraBikeShareSystemsAccessibility2020] is correlated with bike share use, while other research has found that walking trips are less than 600 metres and rarely more than 1200 metres [@millwardActivetransportWalkingBehavior2013] or a median distance of 650 metres [@larsenQuarterMileReexamining2010]. In Hamilton, Hamilton Bike Share will depict a map at some stations to show the user the locations of the other nearest stations within a five minute walk, which suggests that this is an average distance that people are expected to walk. 

In the present case, we found that congested accessibility calculated using the balanced FCA approach increases with a threshold between two and four minutes, but is then maximized at 5 minutes. Accessibility decreases significantly after eight minutes, which is intuitive given that demand on a limited supply increases as more people can reach each bike share station.

For this reason, we experiment with various walking thresholds by conducting a sensitivity analysis to calculate accessibility at different walking times from population cell to bicycle share station: 3 minutes, 5 minutes, 10 minutes, and 15 minutes. We categorize these thresholds as minimum, average, maximum, and extreme, respectively. At each threshold, we compare accessibility between the current system and the original system to examine the contribution of the additional equity stations.

```{r join-population-to-travel-time-data, include=FALSE}
# current system with equity stations
ttm_walk <- left_join(ttm_walk, 
                      population_50x50 %>%
                        st_drop_geometry(),
                      by = "UID")
```

```{r join-sobi-station-to-travel-time-data, include=FALSE}
# current system with equity stations
ttm_walk <- ttm_walk %>% 
  left_join(sobi_hubs %>%
              st_drop_geometry() %>%
              dplyr::select(OBJECTID, 
                            RACKS_AMOU),
            by = c("OBJECTID" = "OBJECTID"))
```

```{r, include=FALSE}
#data frames for current and original systems
names(ttm_walk) <- c("UID", 
                     "hub", 
                     "travel_time",
                     "hub_type",
                     "hub_status",
                     "population",
                     "racks")
```

```{r accessibility-sensibility, eval=FALSE, include=FALSE}
# Testing different thresholds to check how accessibility changes
accessibility_test <- data.frame(threshold = c(3:15), 
                                 accessibility = numeric(13))
for(i in 1:13){
  results_test <- ttm_walk %>%
    dplyr::filter(hub_type == "Conventional" &
                    hub_status == "Active") %>%
    b2sfca(threshold = i +2 )
  accessibility_test$accessibility[i] <- sum(results_test$accessibility$accessibility)
}

ggplot(accessibility_test, 
       aes(x = threshold, y = accessibility)) +
  geom_line()
```

<!-- Calculate accessibility for different thresholds -->

```{r 3-min-conventional, include=FALSE}
results_3min_conventional <- ttm_walk %>%
  dplyr::filter(hub_type == "Conventional" &
                  hub_status == "Active") %>%
  b2sfca(threshold = 3)
```

```{r 3-min-all, include=FALSE}
results_3min_all <- ttm_walk %>%
  dplyr::filter(hub_status == "Active") %>%
  b2sfca(threshold = 3)
```

```{r 3-min-sum-conventional, include=FALSE}
sum(results_3min_conventional$los$los)
sum(results_3min_conventional$accessibility$accessibility)
```

```{r 3-min-sum-all, include=FALSE}
sum(results_3min_all$los$los)
sum(results_3min_all$accessibility$accessibility)
```
```{r 5-min-conventional, include=FALSE}
results_5min_conventional <- ttm_walk %>%
  dplyr::filter(hub_type == "Conventional" &
                  hub_status == "Active") %>%
  b2sfca(threshold = 5)
```

```{r 5-min-all, include=FALSE}
results_5min_all <- ttm_walk %>%
  dplyr::filter(hub_status == "Active") %>%
  b2sfca(threshold = 5)
```

```{r, 5-min-sum-conventional, include=FALSE}
sum(results_5min_conventional$los$los)
sum(results_5min_conventional$accessibility$accessibility)
```

```{r 5-min-sum-all, include=FALSE}
sum(results_5min_all$los$los)
sum(results_5min_all$accessibility$accessibility)
```

```{r 10-min-conventional, include=FALSE}
results_10min_conventional <- ttm_walk %>%
  dplyr::filter(hub_type == "Conventional" &
                  hub_status == "Active") %>%
  b2sfca(threshold = 10)
```

```{r 10-min-all, include=FALSE}
results_10min_all <- ttm_walk %>%
  dplyr::filter(hub_status == "Active") %>%
  b2sfca(threshold = 10)
```

```{r 10-min-sum-conventional, include=FALSE}
sum(results_10min_conventional$los$los)
sum(results_10min_conventional$accessibility$accessibility)
```

```{r, 10-min-sum-all, include=FALSE}
sum(results_10min_all$los$los)
sum(results_10min_all$accessibility$accessibility)
```

```{r 15-min-conventional, include=FALSE}
results_15min_conventional <- ttm_walk %>%
  dplyr::filter(hub_type == "Conventional" &
                  hub_status == "Active") %>%
  b2sfca(threshold = 15)
```

```{r 15-min-all, include=FALSE}
results_15min_all <- ttm_walk %>%
  dplyr::filter(hub_status == "Active") %>%
  b2sfca(threshold = 15)
```

```{r 15-min-sum-conventional, include=FALSE}
sum(results_15min_conventional$los$los)
sum(results_15min_conventional$accessibility$accessibility)
```

```{r 15-min-sum-all, include=FALSE}
sum(results_15min_all$los$los)
sum(results_15min_all$accessibility$accessibility)
```

```{r, bind-all-results, include=FALSE}
los <- rbind(data.frame(results_3min_all$los, system = "All stations", threshold = "3 min"),
             data.frame(results_3min_conventional$los, system = "Conventional", threshold = "3 min"),
             data.frame(results_5min_all$los, system = "All stations", threshold = "5 min"),
             data.frame(results_5min_conventional$los, system = "Conventional", threshold = "5 min"),
             data.frame(results_10min_all$los, system = "All stations", threshold = "10 min"),
             data.frame(results_10min_conventional$los, system = "Conventional", threshold = "10 min"),
             data.frame(results_15min_all$los, system = "All stations", threshold = "15 min"),
             data.frame(results_15min_conventional$los, system = "Conventional", threshold = "15 min"))

accessibility <- rbind(data.frame(results_3min_all$accessibility, system = "All stations", threshold = "3 min"),
                       data.frame(results_3min_conventional$accessibility, system = "Conventional", threshold = "3 min"),
                       data.frame(results_5min_all$accessibility, system = "All stations", threshold = "5 min"),
                       data.frame(results_5min_conventional$accessibility, system = "Conventional", threshold = "5 min"),
                       data.frame(results_10min_all$accessibility, system = "All stations", threshold = "10 min"),
                       data.frame(results_10min_conventional$accessibility, system = "Conventional", threshold = "10 min"),
                       data.frame(results_15min_all$accessibility, system = "All stations", threshold = "15 min"),
                       data.frame(results_15min_conventional$accessibility, system = "Conventional", threshold = "15 min"))
```

```{r, add-geometry-to-results, include=FALSE}
los <- los %>%
  left_join(sobi_hubs %>%
              dplyr::select(OBJECTID),
            by = c("hub" = "OBJECTID")) %>%
  st_as_sf()

accessibility <- accessibility %>%
  left_join(population_50x50 %>%
              dplyr::select(UID),
            by = c("UID" = "UID")) %>%
  st_as_sf()
```

### Minimum Threshold

With a walking distance of three minutes, we find that there are 25.2 bicycle racks per person in the original system. The addition of equity stations increases this ratio slightly to 25.4 bicycles per person. Figure \ref{fig:figure-6} presents a comparison of accessibility between the systems for the population cells. Accessibility is fairly uniform overall, with the exception of two small areas where accessibility is slightly higher.

 ```{r figure-6, echo=FALSE, fig.align = 'center', out.width = "65%", fig.cap = "Accessibility at 3 minutes walk (minimum threshold) compared between current system with equity stations and the original system without equity stations."}
ggplot() +
  geom_sf(data = population_50x50,
          color = "gray") +
  geom_sf(data = accessibility %>%
            dplyr::filter(threshold == "3 min"),
          aes(color = accessibility)) +
  geom_sf(data = sobi_service,
          fill = NA) +
  scale_color_distiller(palette = "PuRd", 
                        direction = 1) +
  facet_grid(system ~ threshold)  +
  geom_sf(data = community_downtown %>%
            dplyr::filter(NAME == "Hamilton"),
          fill = NA,
          color = "dark green") +
  # geom_sf(data =  sobi_hubs %>% 
  #           dplyr::filter(hub_type == "ERI"), 
  #         size = 1.5, shape = 21, 
  #         fill = "green") +
  theme(panel.background = element_rect(fill = "white"))
```

### Average Threshold

With a walking distance of five minutes, we find that there are 68.6 bicycle racks per person in the original system. With the addition of equity stations, there are now 68.8 bicycles per person. Figure \ref{fig:figure-7} presents a comparison of accessibility between the systems. Again, accessibility is fairly uniform, with the exception of one very small area. At this threshold, there are more bicycle racks per person than at the minimum threshold. This occurs because fewer stations can be reached when the travel time is 3 minutes or less.

```{r figure-7, echo=FALSE, fig.align = 'center', out.width = "65%", fig.cap = "Accessibility at 5 minutes walk (average threshold) compared between current system with equity stations and the original system without equity stations."}
#accessibility plot for current system with equity stations at 5 minutes walk
ggplot() +
  geom_sf(data = population_50x50,
          color = "gray") +
  geom_sf(data = accessibility %>%
            dplyr::filter(threshold == "5 min"),
          aes(color = accessibility)) +
  geom_sf(data = sobi_service,
          fill = NA) +
  scale_color_distiller(palette = "PuRd", 
                        direction = 1) +
  facet_grid(system ~ threshold)  +
  geom_sf(data = community_downtown %>%
            dplyr::filter(NAME == "Hamilton"),
          fill = NA,
          color = "dark green") +
  # geom_sf(data =  sobi_hubs %>% 
  #           dplyr::filter(hub_type == "ERI"), 
  #         size = 1.5, shape = 21, 
  #         fill = "green") +
  theme(panel.background = element_rect(fill = "white"))
```

### Maximum Threshold

With a walking distance of ten minutes, we find that there are 3.61 bicycle racks per person in the original system.  With the addition of equity stations, there are now 3.74 bicycles per person. Figure \ref{fig:figure-8} presents a comparison of accessibility between the systems. We begin to see differences in accessibility across the service area, with users near the university and its adjacent neighbourhoods, as well as neighbourhoods north of the downtown area (outlined in green), having slightly higher accessibility. While the differences are modest, they are more apparent at this threshold than at shorter walking distances.

```{r figure-8, echo=FALSE, fig.align = 'center', out.width = "65%", fig.cap = "Accessibility at 10 minutes walk (maximum threshold) compared between current system with equity stations and the original system without equity stations."}
#accessibility plot for current system with equity stations at 10 minutes walk
ggplot() +
  geom_sf(data = population_50x50,
          color = "lightgray") +
  geom_sf(data = accessibility %>%
            dplyr::filter(threshold == "10 min"),
          aes(color = accessibility)) +
  geom_sf(data = sobi_service,
          fill = NA) +
  scale_color_distiller(palette = "PuRd", 
                        direction = 1) +
  facet_grid(system ~ threshold)  +
  geom_sf(data = community_downtown %>%
            dplyr::filter(NAME == "Hamilton"),
          fill = NA,
          color = "dark green") +
  # geom_sf(data =  sobi_hubs %>% 
  #           dplyr::filter(hub_type == "ERI"), 
  #         size = 1.5, shape = 21, 
  #         fill = "green") +
  theme(panel.background = element_rect(fill = "white"))
```

### Extreme Threshold

With a walking distance of fifteen minutes, we find that there are 2.44 bicycle racks per person in the original system.  With the addition of equity stations, there are now 2.55 bicycles per person. Figure \ref{fig:figure-9} presents a comparison of accessibility between the systems. Users near the university and the neighbourhoods north of the downtown area (outlined in green) have the highest accessibility, followed by those who live in the city's downtown area. Accessibility in the east end of the core service area remains low.

```{r figure-9, echo=FALSE, fig.align = 'center', out.width = "65%", fig.cap = "Accessibility at 15 minutes walk (extreme threshold) compared between current system with equity stations and the original system without equity stations."}
#accessibility plot for current system with equity stations at 15 minutes walk
ggplot() +
  geom_sf(data = population_50x50,
          color = "lightgray") +
  geom_sf(data = accessibility %>%
            dplyr::filter(threshold == "15 min"),
          aes(color = accessibility)) +
  geom_sf(data = sobi_service,
          fill = NA) +
  scale_color_distiller(palette = "PuRd", 
                        direction = 1) +
  facet_grid(system ~ threshold)  +
  geom_sf(data = community_downtown %>%
            dplyr::filter(NAME == "Hamilton"),
          fill = NA,
          color = "dark green") +
  # geom_sf(data =  sobi_hubs %>% 
  #           dplyr::filter(hub_type == "ERI"), 
  #         size = 1.5, shape = 21, 
  #         fill = "green") +
  theme(panel.background = element_rect(fill = "white"))
```

## Accessibility by Median Household Income

One of the unique properties of the balanced floating catchment area method is that data can be reaggregated while preserving the total population in the service area and the supply at each station. This avoids demand and supply inflation, and also enables us to present findings in a way that is easier and more intuitive to interpret. Therefore, we reaggregate population and accessibility from the smallest 50 by 50 metres population cells to the median household income for each dissemination area. We divide income by quintiles: bottom 20%, second 20%, third 20%, fourth 20%, and top 20%.

Panels 1 [\ref{fig:figure-bi-map-threshold-3}], 2 [\ref{fig:figure-bi-map-threshold-5}], 3 [\ref{fig:figure-bi-map-threshold-10}], and 4 [\ref{fig:figure-bi-map-threshold-15}] depict bivariate choropleth maps with the combined spatial distribution of accessibility and median household income at different thresholds. Our analysis demonstrates that the extreme threshold of fifteen minutes allows the most people to access a station. We find that stations added to Hamilton's public bicycle share program to increase equity for disadvantaged neighbourhoods achieved their goal by increasing access, albeit only modestly [see Table \ref{tab:accessibility-income}]. By implementing equity stations in more areas with lower median total income in Hamilton, the PBSP has achieved greater horizontal equity by extending the spatial distribution of bicycles across the city. This is particularly evident at the minimum and average thresholds of three and five minutes, respectively, where the equity stations fill a number of gaps in program coverage. The largest gains were made for dissemination areas in the second 20%, where an additional 3,073 and 5,395 people could reach a bicycle share station within three and five minutes walk, respectively, after the addition of the equity station. 

However, we found that dissemination areas with the lowest median household income do not have much greater access to the program [see Table \ref{tab:table-3}]. Income disparities still persist, however only at certain thresholds. With and without equity stations, people in the top 20% of income have the highest level of access at a threshold of ten and fifteen minutes. Although dissemination areas in the second 20% have the highest level of access by a significant amount at lower distance thresholds, the bottom 20%, who may benefit the most from Hamilton Bike Share's equity initiatives, have the lowest access at three minutes threshold and the second lowest access at all other thresholds.

```{r, include=FALSE}
# drop geometry
test <- accessibility

# join accessibility to population cells
test <- test %>% st_join(population_50x50 %>% dplyr::select(-UID)) %>%
  rename(population50x50 = population)
```

```{r, include=FALSE}
test <- test %>%
  st_join(hamilton_da_2016)
```

```{r, include=FALSE}
agg_accessibility_da <- test %>%
  group_by(DA, 
           system,
           threshold) %>%
  summarize(accessibility = sum(accessibility),
            median_total_income = first(median_total_income), 
            .groups = "drop")
```

```{r figure-10, echo=FALSE, fig.align = 'center', out.width = "65%"}
data_map <- agg_accessibility_da %>%
  dplyr::filter(threshold == "3 min", 
                system == "All stations") %>%
  bi_class(x = accessibility, 
           y = median_total_income, 
           style = "quantile", 
           dim = 3) %>%
  st_as_sf() 

bi_map_3_all <- ggplot() +
  geom_sf(data = data_map %>%
            st_buffer(dist = 25, endCapStyle = "SQUARE"),
          mapping = aes(fill = bi_class), 
          color = NA,
          show.legend = FALSE) +
  geom_sf(data = cropped_da,
          fill = NA,
          color = "lightgrey") +
  bi_scale_fill(pal = "DkCyan", 
                dim = 3) +
  theme(panel.background = element_rect(fill = "white"),
        axis.text = element_blank(),
        axis.ticks = element_blank(),
        plot.margin = unit(c(0, 0, 0, 0), "cm"))

legend <- bi_legend(pal = "DkCyan",
                    dim = 3,
                    xlab = "Higher accessibility ",
                    ylab = "Higher income",
                    size = 6) + 
  theme(plot.background = element_rect(color = "lightgrey"))
```

```{r figure-11, echo=FALSE, fig.align = 'center', out.width = "65%"}
data_map <- agg_accessibility_da %>%
  dplyr::filter(threshold == "3 min", 
                system == "Conventional") %>%
  bi_class(x = accessibility, 
           y = median_total_income, 
           style = "quantile", 
           dim = 3) %>%
  st_as_sf() 

bi_map_3_conv <- ggplot() +
  geom_sf(data = data_map %>%
            st_buffer(dist = 25, endCapStyle = "SQUARE"),
          mapping = aes(fill = bi_class), 
          color = NA,
          show.legend = FALSE) +
  geom_sf(data = cropped_da,
          fill = NA,
          color = "lightgrey") +
  bi_scale_fill(pal = "DkCyan", 
                dim = 3) +
  theme(panel.background = element_rect(fill = "white"),
        axis.text = element_blank(),
        axis.ticks = element_blank(),
        plot.margin = unit(c(0, 0, 0, 0), "cm"))
```

```{r figure-bi-map-threshold-3, echo = FALSE, out.width="1\\linewidth", fig.cap="\\label{fig-bivariate-map-threshold-3}Bivariate map of accessibility and income (threshold: 3 min): without equity stations (top panel) and with equity stations (bottom panel)"}
ggdraw() + draw_plot(bi_map_3_conv, 0.00, 0.5, 1, 0.5) + 
  draw_plot(bi_map_3_all, 0.00, 0.0, 1, 0.5) + 
  draw_plot(legend, 0.06, 0.4, 0.2, 0.2)
```

```{r figure-12, echo=FALSE, fig.align = 'center', out.width = "65%"}
data_map <- agg_accessibility_da %>%
  dplyr::filter(threshold == "5 min", 
                system == "All stations") %>%
  bi_class(x = accessibility, 
           y = median_total_income, 
           style = "quantile", 
           dim = 3) %>%
  st_as_sf() 

bi_map_5_all <- ggplot() +
  geom_sf(data = data_map %>%
            st_buffer(dist = 25, endCapStyle = "SQUARE"),
          mapping = aes(fill = bi_class), 
          color = NA,
          show.legend = FALSE) +
  geom_sf(data = cropped_da,
          fill = NA,
          color = "lightgrey") +
  bi_scale_fill(pal = "DkCyan", 
                dim = 3) +
  theme(panel.background = element_rect(fill = "white"),
        axis.text = element_blank(),
        axis.ticks = element_blank(),
        plot.margin = unit(c(0, 0, 0, 0), "cm"))
```

```{r figure-13, echo=FALSE, fig.align = 'center', out.width = "65%"}
data_map <- agg_accessibility_da %>%
  dplyr::filter(threshold == "5 min", 
                system == "Conventional") %>%
  bi_class(x = accessibility, 
           y = median_total_income, 
           style = "quantile", 
           dim = 3) %>%
  st_as_sf() 

bi_map_5_conv <- ggplot() +
  geom_sf(data = data_map %>%
            st_buffer(dist = 25, endCapStyle = "SQUARE"),
          mapping = aes(fill = bi_class), 
          color = NA,
          show.legend = FALSE) +
  geom_sf(data = cropped_da,
          fill = NA,
          color = "lightgrey") +
  bi_scale_fill(pal = "DkCyan", 
                dim = 3) +
  theme(panel.background = element_rect(fill = "white"),
        axis.text = element_blank(),
        axis.ticks = element_blank(),
        plot.margin = unit(c(0, 0, 0, 0), "cm"))
```

```{r figure-bi-map-threshold-5, echo = FALSE, out.width="1\\linewidth", fig.cap="\\label{fig-bivariate-map-threshold-5}Bivariate map of accessibility and income (threshold: 5 min): without equity stations (top panel) and with equity stations (bottom panel)"}
ggdraw() + draw_plot(bi_map_5_conv, 0.00, 0.5, 1, 0.5) + 
  draw_plot(bi_map_5_all, 0.00, 0.0, 1, 0.5) + 
  draw_plot(legend, 0.06, 0.4, 0.2, 0.2)
```

```{r figure-14, echo=FALSE, fig.align = 'center', out.width = "65%"}
data_map <- agg_accessibility_da %>%
  dplyr::filter(threshold == "10 min", 
                system == "All stations") %>%
  bi_class(x = accessibility, 
           y = median_total_income, 
           style = "quantile", 
           dim = 3) %>%
  st_as_sf() 

bi_map_10_all <- ggplot() +
  geom_sf(data = data_map %>%
            st_buffer(dist = 25, endCapStyle = "SQUARE"),
          mapping = aes(fill = bi_class), 
          color = NA,
          show.legend = FALSE) +
  geom_sf(data = cropped_da,
          fill = NA,
          color = "lightgrey") +  bi_scale_fill(pal = "DkCyan", 
                dim = 3) +
  theme(panel.background = element_rect(fill = "white"),
        axis.text = element_blank(),
        axis.ticks = element_blank(),
        plot.margin = unit(c(0, 0, 0, 0), "cm"))
```

```{r figure-15, echo=FALSE, fig.align = 'center', out.width = "65%"}
data_map <- agg_accessibility_da %>%
  dplyr::filter(threshold == "10 min", 
                system == "Conventional") %>%
  bi_class(x = accessibility, 
           y = median_total_income, 
           style = "quantile", 
           dim = 3) %>%
  st_as_sf() 

bi_map_10_conv <- ggplot() +
  geom_sf(data = data_map %>%
            st_buffer(dist = 25, endCapStyle = "SQUARE"),
          mapping = aes(fill = bi_class), 
          color = NA,
          show.legend = FALSE) +
  geom_sf(data = cropped_da,
          fill = NA,
          color = "lightgrey") +
  bi_scale_fill(pal = "DkCyan", 
                dim = 3) +
  theme(panel.background = element_rect(fill = "white"),
        axis.text = element_blank(),
        axis.ticks = element_blank(),
        plot.margin = unit(c(0, 0, 0, 0), "cm"))
```

```{r figure-bi-map-threshold-10, echo = FALSE, out.width="1\\linewidth", fig.cap="\\label{fig-bivariate-map-threshold-10}Bivariate map of accessibility and income (threshold: 10 min): without equity stations (top panel) and with equity stations (bottom panel)"}
ggdraw() + draw_plot(bi_map_10_conv, 0.00, 0.5, 1, 0.5) + 
  draw_plot(bi_map_10_all, 0.00, 0.0, 1, 0.5) + 
  draw_plot(legend, 0.06, 0.4, 0.2, 0.2)
```

```{r figure-16, echo=FALSE, fig.align = 'center', out.width = "65%"}
data_map <- agg_accessibility_da %>%
  dplyr::filter(threshold == "15 min", 
                system == "All stations") %>%
  drop_na() %>% 
  bi_class(x = accessibility, 
           y = median_total_income, 
           style = "quantile", 
           dim = 3) %>%
  st_as_sf() 

bi_map_15_all <- ggplot() +
  geom_sf(data = data_map %>%
            st_buffer(dist = 25, endCapStyle = "SQUARE"),
          mapping = aes(fill = bi_class), 
          color = NA,
          show.legend = FALSE) +
  geom_sf(data = cropped_da,
          fill = NA,
          color = "lightgrey") +
  bi_scale_fill(pal = "DkCyan", 
                dim = 3) +
  theme(panel.background = element_rect(fill = "white"),
        axis.text = element_blank(),
        axis.ticks = element_blank(),
        plot.margin = unit(c(0, 0, 0, 0), "cm"))
```

```{r figure-17, echo=FALSE, fig.align = 'center', out.width = "65%"}
data_map <- agg_accessibility_da %>%
  dplyr::filter(threshold == "15 min", 
                system == "Conventional") %>%
  drop_na() %>% 
  bi_class(x = accessibility, 
           y = median_total_income, 
           style = "quantile", 
           dim = 3) %>%
  st_as_sf() 

bi_map_15_conv <- ggplot() +
  geom_sf(data = data_map %>%
            st_buffer(dist = 25, endCapStyle = "SQUARE"),
          mapping = aes(fill = bi_class), 
          color = NA,
          show.legend = FALSE) +
  geom_sf(data = cropped_da,
          fill = NA,
          color = "lightgrey") +
  bi_scale_fill(pal = "DkCyan", 
                dim = 3) +
  theme(panel.background = element_rect(fill = "white"),
        axis.text = element_blank(),
        axis.ticks = element_blank(),
        plot.margin = unit(c(0, 0, 0, 0), "cm"))
```

```{r figure-bi-map-threshold-15, echo = FALSE, out.width="1\\linewidth", fig.cap="\\label{fig-bivariate-map-threshold-15}Bivariate map of accessibility and income (threshold: 15 min): without equity stations (top panel) and equity stations (bottom panel)"}
ggdraw() + draw_plot(bi_map_15_conv, 0.00, 0.5, 1, 0.5) + 
  draw_plot(bi_map_15_all, 0.00, 0.0, 1, 0.5) + 
  draw_plot(legend, 0.06, 0.4, 0.2, 0.2)
```

```{r, include=FALSE}
# Find the income quantiles of the population served by SoBi
iq <- hamilton_da_2016 %>% 
  dplyr::filter(sobi_service == "Yes") %>%
  pull(median_total_income) %>%
  quantile(c(0, 0.2, 0.4, 0.6, 0.8, 1), na.rm = TRUE)
```

```{r income-all-3, include=FALSE}
# Add a variable to identify the income 
agg_accessibility_all_3 <- test %>% 
  dplyr::filter(system == "All stations", threshold == "3 min") %>%
  mutate(income_quintile = case_when(median_total_income <= iq[2] ~ "Bottom 20%",
                                     median_total_income > iq[2] & median_total_income <= iq[3] ~ "Second 20%",
                                     median_total_income > iq[3] & median_total_income <= iq[4] ~ "Third 20%",
                                     median_total_income > iq[4] & median_total_income <= iq[5] ~ "Fourth 20%",
                                     median_total_income > iq[5] ~ "Top 20%"),
         income_quintile = factor(income_quintile, 
                                  levels = c("Bottom 20%", "Second 20%", "Third 20%", "Fourth 20%", "Top 20%"),
                                  ordered = TRUE))

inc_stats_all_3 <- agg_accessibility_all_3 %>%
  st_drop_geometry() %>%
  #dplyr::filter(system == "All stations", threshold == "10 min") %>%
  group_by(income_quintile) %>%
  summarize(accessibility = sum(accessibility),
            population = sum(population50x50))
```

```{r income-con-3, include=FALSE}
# Add a variable to identify the income 
agg_accessibility_con_3 <- test %>% 
  dplyr::filter(system == "Conventional", threshold == "3 min") %>%
  mutate(income_quintile = case_when(median_total_income <= iq[2] ~ "Bottom 20%",
                                     median_total_income > iq[2] & median_total_income <= iq[3] ~ "Second 20%",
                                     median_total_income > iq[3] & median_total_income <= iq[4] ~ "Third 20%",
                                     median_total_income > iq[4] & median_total_income <= iq[5] ~ "Fourth 20%",
                                     median_total_income > iq[5] ~ "Top 20%"),
         income_quintile = factor(income_quintile, 
                                  levels = c("Bottom 20%", "Second 20%", "Third 20%", "Fourth 20%", "Top 20%"),
                                  ordered = TRUE))

inc_stats_con_3 <- agg_accessibility_con_3 %>%
  st_drop_geometry() %>%
  #dplyr::filter(system == "Conventional", threshold == "10 min") %>%
  group_by(income_quintile) %>%
  summarize(accessibility = sum(accessibility),
            population = sum(population50x50))
```

```{r income-all-5, include=FALSE}
# Add a variable to identify the income 
agg_accessibility_all_5 <- test %>% 
  dplyr::filter(system == "All stations", threshold == "5 min") %>%
  mutate(income_quintile = case_when(median_total_income <= iq[2] ~ "Bottom 20%",
                                     median_total_income > iq[2] & median_total_income <= iq[3] ~ "Second 20%",
                                     median_total_income > iq[3] & median_total_income <= iq[4] ~ "Third 20%",
                                     median_total_income > iq[4] & median_total_income <= iq[5] ~ "Fourth 20%",
                                     median_total_income > iq[5] ~ "Top 20%"),
         income_quintile = factor(income_quintile, 
                                  levels = c("Bottom 20%", "Second 20%", "Third 20%", "Fourth 20%", "Top 20%"),
                                  ordered = TRUE))

inc_stats_all_5 <- agg_accessibility_all_5 %>%
  st_drop_geometry() %>%
  #dplyr::filter(system == "All stations", threshold == "10 min") %>%
  group_by(income_quintile) %>%
  summarize(accessibility = sum(accessibility),
            population = sum(population50x50))
```

```{r income-con-5, include=FALSE}
# Add a variable to identify the income 
agg_accessibility_con_5 <- test %>% 
  dplyr::filter(system == "Conventional", threshold == "5 min") %>%
  mutate(income_quintile = case_when(median_total_income <= iq[2] ~ "Bottom 20%",
                                     median_total_income > iq[2] & median_total_income <= iq[3] ~ "Second 20%",
                                     median_total_income > iq[3] & median_total_income <= iq[4] ~ "Third 20%",
                                     median_total_income > iq[4] & median_total_income <= iq[5] ~ "Fourth 20%",
                                     median_total_income > iq[5] ~ "Top 20%"),
         income_quintile = factor(income_quintile, 
                                  levels = c("Bottom 20%", "Second 20%", "Third 20%", "Fourth 20%", "Top 20%"),
                                  ordered = TRUE))

inc_stats_con_5 <- agg_accessibility_con_5 %>%
  st_drop_geometry() %>%
  #dplyr::filter(system == "Conventional", threshold == "10 min") %>%
  group_by(income_quintile) %>%
  summarize(accessibility = sum(accessibility),
            population = sum(population50x50))
```

```{r income-all-10, include=FALSE}
# Add a variable to identify the income 
agg_accessibility_all_10 <- test %>% 
  dplyr::filter(system == "All stations", threshold == "10 min") %>%
  mutate(income_quintile = case_when(median_total_income <= iq[2] ~ "Bottom 20%",
                                     median_total_income > iq[2] & median_total_income <= iq[3] ~ "Second 20%",
                                     median_total_income > iq[3] & median_total_income <= iq[4] ~ "Third 20%",
                                     median_total_income > iq[4] & median_total_income <= iq[5] ~ "Fourth 20%",
                                     median_total_income > iq[5] ~ "Top 20%"),
         income_quintile = factor(income_quintile, 
                                  levels = c("Bottom 20%", "Second 20%", "Third 20%", "Fourth 20%", "Top 20%"),
                                  ordered = TRUE))

inc_stats_all_10 <- agg_accessibility_all_10 %>%
  st_drop_geometry() %>%
  #dplyr::filter(system == "All stations", threshold == "10 min") %>%
  group_by(income_quintile) %>%
  summarize(accessibility = sum(accessibility),
            population = sum(population50x50))
```

```{r income-con-10, include=FALSE}
# Add a variable to identify the income 
agg_accessibility_con_10 <- test %>% 
  dplyr::filter(system == "Conventional", threshold == "10 min") %>%
  mutate(income_quintile = case_when(median_total_income <= iq[2] ~ "Bottom 20%",
                                     median_total_income > iq[2] & median_total_income <= iq[3] ~ "Second 20%",
                                     median_total_income > iq[3] & median_total_income <= iq[4] ~ "Third 20%",
                                     median_total_income > iq[4] & median_total_income <= iq[5] ~ "Fourth 20%",
                                     median_total_income > iq[5] ~ "Top 20%"),
         income_quintile = factor(income_quintile, 
                                  levels = c("Bottom 20%", "Second 20%", "Third 20%", "Fourth 20%", "Top 20%"),
                                  ordered = TRUE))

inc_stats_con_10 <- agg_accessibility_con_10 %>%
  st_drop_geometry() %>%
  #dplyr::filter(system == "Conventional", threshold == "10 min") %>%
  group_by(income_quintile) %>%
  summarize(accessibility = sum(accessibility),
            population = sum(population50x50))
```

```{r income-all-15, include=FALSE}
# Add a variable to identify the income 
agg_accessibility_all_15 <- test %>% 
  dplyr::filter(system == "All stations", threshold == "15 min") %>%
  mutate(income_quintile = case_when(median_total_income <= iq[2] ~ "Bottom 20%",
                                     median_total_income > iq[2] & median_total_income <= iq[3] ~ "Second 20%",
                                     median_total_income > iq[3] & median_total_income <= iq[4] ~ "Third 20%",
                                     median_total_income > iq[4] & median_total_income <= iq[5] ~ "Fourth 20%",
                                     median_total_income > iq[5] ~ "Top 20%"),
         income_quintile = factor(income_quintile, 
                                  levels = c("Bottom 20%", "Second 20%", "Third 20%", "Fourth 20%", "Top 20%"),
                                  ordered = TRUE))

inc_stats_all_15 <- agg_accessibility_all_15 %>%
  st_drop_geometry() %>%
  #dplyr::filter(system == "All stations", threshold == "10 min") %>%
  group_by(income_quintile) %>%
  summarize(accessibility = sum(accessibility),
            population = sum(population50x50))
```

```{r income-con-15, include=FALSE}
# Add a variable to identify the income 
agg_accessibility_con_15 <- test %>% 
  dplyr::filter(system == "Conventional", threshold == "15 min") %>%
  mutate(income_quintile = case_when(median_total_income <= iq[2] ~ "Bottom 20%",
                                     median_total_income > iq[2] & median_total_income <= iq[3] ~ "Second 20%",
                                     median_total_income > iq[3] & median_total_income <= iq[4] ~ "Third 20%",
                                     median_total_income > iq[4] & median_total_income <= iq[5] ~ "Fourth 20%",
                                     median_total_income > iq[5] ~ "Top 20%"),
         income_quintile = factor(income_quintile, 
                                  levels = c("Bottom 20%", "Second 20%", "Third 20%", "Fourth 20%", "Top 20%"),
                                  ordered = TRUE))

inc_stats_con_15 <- agg_accessibility_con_15 %>%
  st_drop_geometry() %>%
  #dplyr::filter(system == "Conventional", threshold == "10 min") %>%
  group_by(income_quintile) %>%
  summarize(accessibility = sum(accessibility),
            population = sum(population50x50))
```

```{r income-all-hubs, include=FALSE}
all_hubs <- rbind(inc_stats_all_3,
                  inc_stats_all_5,
                  inc_stats_all_10,
                  inc_stats_all_15) %>%
  drop_na() # there is a very small number of population cells without income data

all_hubs
```

```{r income-conventional-hubs, include=FALSE}
conventional_hubs <- rbind(inc_stats_con_3,
                           inc_stats_con_5,
                           inc_stats_con_10,
                           inc_stats_con_15) %>%
  drop_na() # there is a very small number of population cells without income data

conventional_hubs
```

```{r accessibility-income, echo=FALSE}
accessibility_income <- cbind(
  conventional_hubs,
  all_hubs[, 2:3])

colnames(accessibility_income) <- c("iq", "accessibility_conv", "population_conv", "accessibility_all", "population_all")

accessibility_income <- accessibility_income %>%
  mutate(accessibility_conv = round(accessibility_conv, 3), 
         population_conv = round(population_conv),
         accessibility_all = round(accessibility_all, 3), 
         population_all = round(population_all),
         accessibility_diff = accessibility_all - accessibility_conv,
         population_diff = population_all - population_conv)

kable(accessibility_income,
      "latex",
      booktabs = TRUE,
      col.names = c("Income Quintile",
                    "Accessibility",
                    "Population",
                    "Accessibility",
                    "Population",
                    "Accessibility",
                    "Population"),
      align = c("l", "c", "c", "c", "c", "c", "c"),
      caption = "\\label{tab:accessibility-by-income}Accessibility and population serviced by income quintile and between systems (with and without equity stations).") %>%
  kable_styling(latex_options = c("striped", "scale_down")) %>%
  pack_rows("Threshold - 3 minutes", 1, 5, 
            label_row_css = "background-color: #8f9498; color: #fff;") %>%
  pack_rows("Threshold - 5 minutes", 6, 10, 
            label_row_css = "background-color: #8f9498; color: #fff;") %>%
  pack_rows("Threshold - 10 minutes", 11, 15, 
            label_row_css = "background-color: #8f9498; color: #fff;") %>%
  pack_rows("Threshold - 15 minutes", 16, 20, 
            label_row_css = "background-color: #8f9498; color: #fff;") %>%
  add_header_above(c(" " = 1, "Without Equity Stations" = 2, "With Equity Stations" = 2, "Difference" = 2)) %>%
  #column_spec(2, color = "white",
  #background = spec_color(accessibility_income$accessibility[1:40], end = 1)) %>%
  footnote(general = " ",
           alphabet = c("With equity stations = Hamilton Bike Share current system (118 conventional stations, 12 equity stations)", "Without equity stations = Hamilton Bike Share original system (118 conventional stations, no equity stations)"))
```

Discussion
===================

Using disaggregate data, we examined spatial equity and accessibility to Hamilton Bike Share, with a particular focus on assessing the contribution of the program's equity stations. Our balanced floating catchment area approach, combined with pycnophylactic interpolation, enabled us to measure accessibility on a micro sale. This differentiates our analysis from similar papers exploring equity in PBSPs that use larger geographical units of analysis or that focus on station location instead of level of service. In this way, our paper has made contributions in a positive way by applying an intuitive and useful approach to measure accessibility to a PBSP, and in a normative way by serving to inform future investments in cycle infrastructure for Hamilton Bike Share.

The sensitivity analysis revealed that accessibility to Hamilton Bike Share stations is maximized at five minutes and decreases significantly by eight minutes [see Table \ref{tab:accessibility-income}]. This reflects the normative guide, advertised on some bicycle share stations in Hamilton, that people can access other stations within a five minute walk if the station of origin has no bicycles. We find that over 118,000 people can access a bicycle share station within a 15 minute walk, which represents roughly 85% of the total population in the core service area [see Table \ref{tab:accessibility-income}]. At a minimum threshold of three minutes, too few stations can be accessed which leads to lower levels of accessibility. However, accessibility is at its lowest after eight minutes whereby congestion occurs due to increased potential demand. The City of Hamilton has recognized from the launch of the PBSP that significantly more stations and bicycles are needed to service the area [@hamiltonsobi2015]. With a service area of 40 square kilometres, Hamilton should have between 380 and 440 stations, instead of 130, and 1,500 bicycles instead of 900 [@hamiltonsobi2015]. Reduced capacity within the system leads to gaps in coverage in some areas of the city "with some areas not having the recommended station density of 300m between stations or 10 stations per square km" [@hamiltonsobi2015]. This study illustrates the consequences of an imbalanced system whereby levels of accessibility are not equitable across income groups and become very low when congestion occurs. 

We found that equity stations achieved their goal of increasing horizontal equity in Hamilton's core service area. Panels 1[\ref{fig:figure-bi-map-threshold-3}], 2 [\ref{fig:figure-bi-map-threshold-5}], 3 [\ref{fig:figure-bi-map-threshold-10}], and 4 [\ref{fig:figure-bi-map-threshold-15}] demonstrate how gaps in service were filled by these additional stations. In this respect, there are some commonalities between the expansions of Hamilton Bike Share and that of Citi Bike in New York. Babgoli et al. [-@babagoliExploringHealthSpatial2019] found a slight but not statistically significant increase in the proportion of neighbourhoods with the highest levels of poverty with stations after the Citi Bike expansion in 2015. Although the Citi Bike expansion was not specifically driven by a desire to reduce inequities in access, 16% of neighbourhoods with the most poverty had stations compared to 12% before. With the addition of equity stations, there were large gains in accessibility for the second 20% at the average threshold, over 5,000 more people, but much smaller gains for the bottom 20% with only 326 more people.  

Vertical inequities, however, continue to persist despite the addition of equity stations. While the addition of equity stations modestly increases accessibility for all income groups at all thresholds, they did not increase accessibility significantly for any single income group. Most importantly, individuals in the bottom 20% median household income quintile have the second lowest level of access to Hamilton Bike Share at most thresholds (average, maximum, and extreme). At the minimum threshold, the bottom 20% have the lowest level of access. While previous research found that neighbourhoods with more disadvantage are better serviced by Hamilton Bike Share, the authors used the Pampalon Deprivation Index to determine the level of disadvantage for dissemination areas _across_ the city not just within the core service area [@hosfordWhoArePublic2018]. Instead, we use median household income for each dissemination area _within_ the core service area. We conclude that Hamilton's PBSP, while by default located in areas with more deprivation compared to other cities, has disparities in accessibility between income groups. With equity stations, many areas with low median household income in the east end of the service area continue to have low accessibility. At higher thresholds of 10 and 15 minutes, the top 20% have the highest level of access to Hamilton Bike Share. This aligns with other studies from Tampa [@chenExploringEquityPerformance2019] and Seattle [@mooneyFreedomStationSpatial2019], which have found disparities in station location or access to bicycles between levels of income and education.

Based on our analysis, we identified specific areas that have both low accessibility and low median household income which would benefit from an increased supply of public bicycles. These empirical findings provide support to the City of Hamilton's efforts to increase equity and balance the system, and confirm that additional stations and bicycles are needed to improve access not only for the bottom 20% but for all income groups. Panels 1[\ref{fig:figure-bi-map-threshold-3}], 2 [\ref{fig:figure-bi-map-threshold-5}], 3 [\ref{fig:figure-bi-map-threshold-10}], and 4 [\ref{fig:figure-bi-map-threshold-15}] highlight potential locations for new equity stations.

Study Limitations
===================

This paper did not examine or compare ridership data between conventional and equity stations. Therefore, further research is needed to determine whether the addition of equity stations encouraged more cycling for low-income individuals living near them. Other studies have specifically looked at differences in trip type, frequency, or length among users from disadvantaged neighbourhoods [@caspiBikesharingPhiladelphiaLowerincome2019; @qianBikesharingEquityDisadvantaged2020; @wangNeighborhoodSociodemographicCharacteristics2019], but our analysis is limited by the lack of publicly available route or user data to conduct similar analyses for Hamilton Bike Share. 

Conclusion
===================

The addition of specific equity stations to the public bicycle share program in Hamilton, Ontario had the net effect of increasing accessibility and reducing both horizontal and vertical inequities. In particular, accessibility improved the most for those in the second 20% median household income at all thresholds, but the gains were only modest for all income groups. Dissemination areas with the bottom 20% had the lowest accessibility at three minutes, and second lowest levels of accessibility at five, ten, and fifteen minutes. Congestion effects were observed at higher thresholds, with accessibility decreasing significantly once the catchment area is increased to 10 minutes walking.  

Wang and Lindsey [-@wangNewBikeShare2019] have noted that there is a lack of research that examines how bike share users' behaviour changes as a result of program changes to station locations or improvements in accessibility. As such, a logical next step to this research is to examine whether Hamilton Bike Share's equity stations increased ridership or resulted in new memberships in areas that were previously under-served. An examination of the types of trips undertaken by residents in these areas would also be informative, such as the study undertaken by Caspi and Norland [-@caspiBikesharingPhiladelphiaLowerincome2019] after bike share stations were implemented in low-income Philadelphia neighbourhoods. The bulk of cycling facilities that have been built in Hamilton to date located in the core service area near the conventional stations. It would be worthwhile to explore the route choice of bike share trips departing or ending at the equity stations and to identify factors that specifically influence trips from these stations, which would extend existing studies conducted by Scott and colleagues [@luUnderstandingBikeShare2018; @scottWhatFactorsInfluence2019; @scottRouteChoiceBike2021]. This paper, combined with additional studies such as those conceptualized above, would serve as a valuable case study for Hamilton and other cities with PBSPs who wish to evaluate and address spatial inequities in accessibility and transportation options in urban areas.

References {#references .unnumbered}
===================
